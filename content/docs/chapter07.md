---
title: "Chapter 7: Bollinger Bands 전략"
weight: 7
bookToc: true
---

# Chapter 7: Bollinger Bands 전략

Bollinger Bands는 John Bollinger가 개발한 변동성 기반 기술적 지표입니다. 가격의 표준편차를 이용해 동적으로 변하는 밴드를 형성하며, 과매수/과매도 판단과 변동성 변화를 감지하는 데 사용됩니다.

## 7.1 Bollinger Bands의 구조

### 7.1.1 Bollinger Bands 계산

Bollinger Bands는 세 개의 라인으로 구성됩니다:

**1. 중간 밴드 (Middle Band)**: 단순 이동평균

$$
\text{MB}_t = \text{SMA}_n(P_t)
$$

**2. 상단 밴드 (Upper Band)**: 중간 밴드 + (표준편차 × k)

$$
\text{UB}_t = \text{MB}_t + k \cdot \sigma_n(P_t)
$$

**3. 하단 밴드 (Lower Band)**: 중간 밴드 - (표준편차 × k)

$$
\text{LB}_t = \text{MB}_t - k \cdot \sigma_n(P_t)
$$

여기서:
- $n$은 기간 (일반적으로 20일)
- $k$는 표준편차 배수 (일반적으로 2)
- $\sigma_n(P_t)$는 $n$ 기간 동안의 가격 표준편차

### 7.1.2 표준편차 계산

$$
\sigma_n(P_t) = \sqrt{\frac{1}{n} \sum_{i=0}^{n-1} (P_{t-i} - \text{MB}_t)^2}
$$

### 7.1.3 Bollinger Bands의 특성

**변동성 측정**:
- 밴드 폭이 넓어짐: 변동성 증가
- 밴드 폭이 좁아짐: 변동성 감소

**가격 포함률**:
- 약 95%의 가격이 ±2σ 밴드 내에 위치 (정규분포 가정)
- 밴드 외부로 가격이 벗어나는 것은 상대적으로 드문 사건

**동적 조정**:
- 시장 변동성에 따라 밴드가 자동으로 확장/축소
- RSI처럼 고정된 임계값(30/70)이 아님

## 7.2 Bollinger Bands 트레이딩 전략

### 7.2.1 밴드 반등 전략 (Mean Reversion)

**기본 개념**: 가격이 밴드 끝에 도달하면 평균으로 회귀한다

**매수 신호**:
- 가격이 하단 밴드에 닿거나 아래로 벗어남
- 과매도 상태로 판단 → 반등 기대

**매도 신호**:
- 가격이 상단 밴드에 닿거나 위로 벗어남
- 과매수 상태로 판단 → 조정 기대

**특징**:
- 횡보장/범위 제한 시장에서 효과적
- 강한 추세에서는 밴드를 따라 계속 움직일 수 있음 (밴드 워킹)

### 7.2.2 밴드 돌파 전략 (Breakout)

**기본 개념**: 변동성 수축 후 확장 시 강한 추세 발생

**매수 신호**:
- 밴드 폭이 좁아진 후 (스퀴즈)
- 가격이 상단 밴드를 상향 돌파
- 상승 추세 시작 신호

**매도 신호**:
- 밴드 폭이 좁아진 후
- 가격이 하단 밴드를 하향 돌파
- 하락 추세 시작 신호

**특징**:
- 추세 시장에서 효과적
- 밴드 워킹(Band Walking) 포착 가능

### 7.2.3 밴드 폭 분석 (Bandwidth)

**Bandwidth 계산**:

$$
\text{Bandwidth}_t = \frac{\text{UB}_t - \text{LB}_t}{\text{MB}_t} \times 100
$$

**해석**:
- 낮은 Bandwidth: 변동성 수축 → 큰 움직임 임박 (스퀴즈)
- 높은 Bandwidth: 변동성 확장 → 추세 진행 중

**스퀴즈 (Squeeze)**:
- Bandwidth가 6개월 최저점에 도달
- 큰 가격 움직임이 곧 발생할 신호
- 방향은 알 수 없음 (돌파 확인 필요)

### 7.2.4 %B 지표

가격의 밴드 내 상대적 위치를 나타냄:

$$
\%B_t = \frac{P_t - \text{LB}_t}{\text{UB}_t - \text{LB}_t}
$$

**해석**:
- %B = 1: 가격이 상단 밴드에 위치
- %B = 0: 가격이 하단 밴드에 위치
- %B = 0.5: 가격이 중간 밴드에 위치
- %B > 1: 가격이 상단 밴드 위에 위치 (매우 강함)
- %B < 0: 가격이 하단 밴드 아래에 위치 (매우 약함)

## 7.3 Bollinger Bands vs. RSI

| 특성 | Bollinger Bands | RSI |
|------|----------------|-----|
| 기반 | 변동성 (표준편차) | 모멘텀 (상승/하락 강도) |
| 임계값 | 동적 (시장 변동성에 따라 변화) | 고정 (30/70) |
| 시장 적응성 | 높음 | 낮음 |
| 추세 포착 | 가능 (밴드 돌파 전략) | 어려움 |
| 변동성 정보 | 제공 (밴드 폭) | 제공 안 함 |
| 사용 난이도 | 상대적으로 복잡 | 단순 |

## 7.4 실전 구현

이번 챕터의 코드에서는 다음을 구현합니다:

1. **밴드 반등 전략**: 하단 밴드 터치 시 매수, 상단 밴드 터치 시 매도
2. **밴드 돌파 전략**: 밴드 스퀴즈 후 돌파 시 추세 추종
3. **%B 기반 전략**: %B 값을 이용한 매매
4. **성과 비교**: Buy & Hold vs. 각 BB 전략

### 7.4.1 Backtrader에서 Bollinger Bands 사용

```python
import backtrader as bt

class BollingerBandsStrategy(bt.Strategy):
    params = (
        ('period', 20),
        ('devfactor', 2.0),
    )

    def __init__(self):
        # Bollinger Bands 지표 추가
        self.bband = bt.indicators.BollingerBands(
            self.data.close,
            period=self.params.period,
            devfactor=self.params.devfactor
        )

        # 개별 밴드 접근
        self.top_band = self.bband.top
        self.mid_band = self.bband.mid
        self.bot_band = self.bband.bot
```

### 7.4.2 밴드 반등 전략 로직

```python
def next(self):
    if not self.position:
        # 하단 밴드 터치: 매수
        if self.data.close < self.bot_band:
            self.buy()
    else:
        # 상단 밴드 터치: 매도
        if self.data.close > self.top_band:
            self.close()
```

### 7.4.3 밴드 돌파 전략 로직

```python
def next(self):
    # Bandwidth 계산
    bandwidth = (self.top_band - self.bot_band) / self.mid_band

    # 스퀴즈 감지 (낮은 변동성)
    if bandwidth < threshold:
        self.squeeze_detected = True

    if self.squeeze_detected:
        # 상단 밴드 돌파: 매수
        if self.data.close > self.top_band:
            self.buy()
            self.squeeze_detected = False
```

## 7.5 실행 결과

코드를 실행한 결과입니다 (Apple Inc., 2019-2024):

```
==================================================
Chapter 7: Bollinger Bands 전략
==================================================

=== 백테스트 설정 ===
- 티커: AAPL
- 기간: 2019-01-01 ~ 2024-01-01
- 초기 자금: $10,000.00
- 수수료: 0.1%
- Bollinger Bands: 기간=20, 표준편차=2

==================================================
[1/4] 밴드 반등(Mean Reversion) 전략 실행 중...

==================================================
=== 밴드 반등 전략 성과 ===
==================================================

기본 지표:
- 초기 자금: $10,000.00
- 최종 자금: $16,308.31
- 총 수익률: +63.08%

Sharpe Ratio: 0.900

최대 낙폭:
- Max Drawdown: 24.85%
- DD Duration: 379 days

거래 통계:
- 총 거래: 13
- 승: 10, 패: 3
- 승률: 76.9%
- 평균 수익: $799.07
- 평균 손실: $-560.81

==================================================
[2/4] 밴드 돌파(Breakout) 전략 실행 중...

==================================================
=== 밴드 돌파 전략 성과 ===
==================================================

기본 지표:
- 초기 자금: $10,000.00
- 최종 자금: $20,276.96
- 총 수익률: +102.77%

Sharpe Ratio: 1.232

최대 낙폭:
- Max Drawdown: 10.45%
- DD Duration: 353 days

거래 통계:
- 총 거래: 10
- 승: 6, 패: 4
- 승률: 60.0%
- 평균 수익: $2122.26
- 평균 손실: $-614.14

==================================================
[3/4] %B 기반 전략 실행 중...

==================================================
=== %B 기반 전략 성과 ===
==================================================

기본 지표:
- 초기 자금: $10,000.00
- 최종 자금: $10,463.13
- 총 수익률: +4.63%

거래 통계:
- 총 거래: 17
- 승: 10, 패: 7
- 승률: 58.8%

==================================================
=== 전략 비교 요약 ===
==================================================

Buy & Hold:          +408.08%
밴드 반등 전략:       +63.08%
밴드 돌파 전략:       +102.77%
%B 기반 전략:         +4.63%
```

![Bollinger Bands 전략 비교](/images/chapter07/bollinger_bands_strategy.png)

### 차트 해석

**상단 패널 - 가격과 Bollinger Bands**:
- 파란선은 Apple 주가입니다
- 주황선(중간 밴드)은 20일 SMA입니다
- 초록선(상단 밴드)과 빨간선(하단 밴드)은 ±2 표준편차입니다
- 밴드 폭이 좁아지면 변동성 수축(스퀴즈), 넓어지면 변동성 확장을 의미합니다
- 2020년 3월 코로나 폭락 시 밴드가 크게 확장되었습니다

**중간 패널 - Bandwidth (변동성 지표)**:
- 주황선은 밴드 폭을 백분율로 나타냅니다
- 낮은 값 = 변동성 수축 (큰 움직임 임박)
- 높은 값 = 변동성 확장 (추세 진행 중)
- 2019년 말과 2023년 중반에 스퀴즈가 발생했습니다

**하단 패널 - 전략 성과 비교**:
- 파란선(Buy & Hold)이 여전히 가장 높습니다
- 주황선(밴드 돌파)이 두 번째로 우수한 성과를 보였습니다
- 초록선(밴드 반등)은 세 번째입니다
- 빨간선(%B 전략)은 거의 제자리걸음입니다

## 7.6 핵심 인사이트

실행 결과에서 얻을 수 있는 중요한 교훈:

### 1. 밴드 돌파 전략의 우수성

**밴드 돌파 전략이 최고 성과**:
- **수익률: +102.77%** (지금까지 본 전략 중 최고!)
- **Sharpe Ratio: 1.232** (우수한 위험 조정 수익률)
- **Max Drawdown: 10.45%** (매우 낮음!)
- **평균 수익: $2,122** per trade

**왜 이렇게 좋은 결과가 나왔을까?**
- 변동성 수축 후 확장을 정확히 포착
- 강한 추세의 초기 단계에 진입
- 낮은 Drawdown으로 심리적 부담 최소화
- 10거래로 적절한 거래 빈도 유지

### 2. 전략별 성과 비교

| 전략 | 수익률 | Sharpe | Max DD | 거래 | 승률 |
|------|--------|--------|--------|------|------|
| 밴드 돌파 | +102.77% | 1.232 | 10.45% | 10 | 60% |
| 밴드 반등 | +63.08% | 0.900 | 24.85% | 13 | 76.9% |
| %B 전략 | +4.63% | 0.143 | 30.16% | 17 | 58.8% |

**밴드 돌파 > 밴드 반등 > %B**:
- 돌파 전략이 반등 전략보다 40% 더 높은 수익
- 돌파 전략의 Drawdown이 반등의 절반 수준
- %B 전략은 과도한 거래로 수수료 부담

### 3. 지금까지 배운 전략 종합 비교

| 챕터 | 전략 | 수익률 | Sharpe | 거래 |
|------|------|--------|--------|------|
| Ch5 | SMA(50/200) | +11.07% | 0.266 | 2 |
| Ch6 | RSI(30/70) | +113.32% | 1.230 | 5 |
| Ch7 | BB 돌파 | +102.77% | 1.232 | 10 |
| Ch7 | BB 반등 | +63.08% | 0.900 | 13 |

**RSI와 BB 돌파가 비슷한 성과**:
- RSI: +113.32%, Sharpe 1.230
- BB 돌파: +102.77%, Sharpe 1.232
- 두 전략 모두 역추세 요소를 가짐
- BB 돌파는 추세도 함께 포착

### 4. 밴드 반등 vs 밴드 돌파

**밴드 반등 (Mean Reversion)**:
- 승률 높음(76.9%) but 작은 수익
- 하단 밴드 터치 → 평균 회귀 기대
- 횡보장에 유리
- 강한 추세에서 손실 (밴드 워킹)

**밴드 돌파 (Breakout)**:
- 승률 낮음(60%) but 큰 수익
- 스퀴즈 후 돌파 → 추세 시작 포착
- 추세 시장에 유리
- 낮은 Max Drawdown (10.45%)

**Apple 2019-2024는 추세 시장**:
- 강한 상승 추세가 여러 번 발생
- 돌파 전략이 추세를 잘 포착
- 반등 전략은 추세에서 조기 매도

### 5. %B 전략의 실패

**왜 %B 전략이 실패했나?**:
- **과도한 거래**: 17거래 (가장 많음)
- **빈번한 진출입**: 수수료 부담 증가
- **명확하지 않은 신호**: %B 임계값이 모호
- **Max Drawdown 30.16%**: 가장 높음

**교훈**: 복잡한 지표가 항상 좋은 것은 아님

### 6. Bandwidth의 중요성

**변동성 수축-확장 사이클**:
- 낮은 Bandwidth (스퀴즈) → 큰 움직임 임박
- 돌파 전략은 이 패턴을 활용
- 2019년 말 스퀴즈 → 2020년 초 급등
- 2020년 3월 폭락 → 높은 Bandwidth

### 7. 실전 적용 교훈

**이 결과가 주는 교훈**:
- ✅ BB 돌파 전략이 우수한 리스크-수익 프로필
- ✅ 변동성 기반 접근이 효과적
- ✅ 낮은 Max Drawdown으로 심리적 유리
- ⚠️ 추세 시장에서는 돌파, 횡보장에서는 반등
- ⚠️ 시장 환경 판별이 중요
- ⚠️ 너무 많은 거래는 수수료로 수익 감소

## 7.7 Bollinger Bands 활용 팁

### 7.7.1 밴드 워킹 (Band Walking)

**현상**: 강한 추세에서 가격이 상단(또는 하단) 밴드를 따라 계속 움직임

**대응**:
- 반등 전략 중단
- 추세 추종 전략으로 전환
- 중간 밴드를 손절 기준으로 사용

### 7.7.2 더블 탑/바텀

- 가격이 상단 밴드를 터치했다가 다시 터치 (더블 탑)
- 두 번째 터치가 첫 번째보다 높지만 밴드를 넘지 못함
- 반전 신호 가능

### 7.7.3 다른 지표와 결합

**추세 확인**:
- Bollinger Bands + 이동평균: 추세 방향 확인
- 중간 밴드가 상승 중이면 상승 추세

**모멘텀 확인**:
- Bollinger Bands + RSI: 신호 신뢰도 증가
- 하단 밴드 터치 + RSI 과매도 → 강한 매수 신호

**거래량 확인**:
- 밴드 돌파 시 거래량 증가하면 신뢰도 상승

## 7.8 개선 방향

Bollinger Bands 전략을 개선할 수 있는 방법:

1. **동적 매개변수**: 시장 변동성에 따라 기간 및 표준편차 배수 조정
2. **스퀴즈 임계값**: 역사적 Bandwidth 분포 분석으로 최적 임계값 결정
3. **포지션 크기**: Bandwidth에 따라 포지션 크기 조절 (낮은 변동성 → 큰 포지션)
4. **손절/익절**: ATR 기반 동적 손절매 설정
5. **다중 시간프레임**: 상위 시간프레임 밴드와 하위 시간프레임 신호 결합

## 다음 단계

다음 챕터에서는 여러 기술적 지표를 결합한 다중 지표 전략을 배웁니다. 이동평균, RSI, Bollinger Bands를 함께 사용하여 신호 신뢰도를 높이는 방법을 다룹니다.

---

**코드 실행:**
```bash
cd codes
uv run chapter07/01_bollinger_bands_strategy.py
```
