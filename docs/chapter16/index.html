<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Chapter 16: 머신러닝 기반 전략 (Part 2)# 16.1 소개# 이전 장에서는 기본적인 머신러닝 모델을 학습했습니다. 이 장에서는 더 고급 기법과 Backtrader와의 통합, 그리고 실전 적용 방법을 학습합니다.
16.2 Feature Importance 분석# 16.2.1 트리 기반 모델의 Feature Importance# 랜덤 포레스트와 그래디언트 부스팅은 각 특성의 중요도를 제공합니다:
$$\text{Importance}_i = \frac{\sum_{t \in T} \Delta \text{Gini}_i(t)}{|T|}$$여기서:
$T$: 모든 트리 집합 $\Delta \text{Gini}_i(t)$: 노드 $t$에서 특성 $i$에 의한 불순도 감소 활용:
중요하지 않은 특성 제거 전략 해석 새로운 특성 아이디어 발굴 16.2.2 Permutation Importance# 특성을 무작위로 섞었을 때 성능 하락 정도로 중요도 측정:
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://k2sebeom.github.io/intro-to-backtesting/docs/chapter16/"><meta property="og:site_name" content="파이썬으로 배우는 백테스팅 입문"><meta property="og:title" content="Chapter 16: 머신러닝 기반 전략 (2)"><meta property="og:description" content="Chapter 16: 머신러닝 기반 전략 (Part 2)# 16.1 소개# 이전 장에서는 기본적인 머신러닝 모델을 학습했습니다. 이 장에서는 더 고급 기법과 Backtrader와의 통합, 그리고 실전 적용 방법을 학습합니다.
16.2 Feature Importance 분석# 16.2.1 트리 기반 모델의 Feature Importance# 랜덤 포레스트와 그래디언트 부스팅은 각 특성의 중요도를 제공합니다:
$$\text{Importance}_i = \frac{\sum_{t \in T} \Delta \text{Gini}_i(t)}{|T|}$$여기서:
$T$: 모든 트리 집합 $\Delta \text{Gini}_i(t)$: 노드 $t$에서 특성 $i$에 의한 불순도 감소 활용:
중요하지 않은 특성 제거 전략 해석 새로운 특성 아이디어 발굴 16.2.2 Permutation Importance# 특성을 무작위로 섞었을 때 성능 하락 정도로 중요도 측정:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2026-02-05T03:01:26+00:00"><meta itemprop=name content="Chapter 16: 머신러닝 기반 전략 (2)"><meta itemprop=description content="Chapter 16: 머신러닝 기반 전략 (Part 2)# 16.1 소개# 이전 장에서는 기본적인 머신러닝 모델을 학습했습니다. 이 장에서는 더 고급 기법과 Backtrader와의 통합, 그리고 실전 적용 방법을 학습합니다.
16.2 Feature Importance 분석# 16.2.1 트리 기반 모델의 Feature Importance# 랜덤 포레스트와 그래디언트 부스팅은 각 특성의 중요도를 제공합니다:
$$\text{Importance}_i = \frac{\sum_{t \in T} \Delta \text{Gini}_i(t)}{|T|}$$여기서:
$T$: 모든 트리 집합 $\Delta \text{Gini}_i(t)$: 노드 $t$에서 특성 $i$에 의한 불순도 감소 활용:
중요하지 않은 특성 제거 전략 해석 새로운 특성 아이디어 발굴 16.2.2 Permutation Importance# 특성을 무작위로 섞었을 때 성능 하락 정도로 중요도 측정:"><meta itemprop=dateModified content="2026-02-05T03:01:26+00:00"><meta itemprop=wordCount content="936"><title>Chapter 16: 머신러닝 기반 전략 (2) | 파이썬으로 배우는 백테스팅 입문</title><link rel=icon href=/intro-to-backtesting/favicon.png><link rel=manifest href=/intro-to-backtesting/manifest.json><link rel=canonical href=https://k2sebeom.github.io/intro-to-backtesting/docs/chapter16/><link rel=stylesheet href=/intro-to-backtesting/book.min.cc2c524ed250aac81b23d1f4af87344917b325208841feca0968fe450f570575.css integrity="sha256-zCxSTtJQqsgbI9H0r4c0SRezJSCIQf7KCWj+RQ9XBXU=" crossorigin=anonymous><script defer src=/intro-to-backtesting/fuse.min.js></script><script defer src=/intro-to-backtesting/en.search.min.045ca227d4176807ad581a410adc82f05790d9bf1e41b6de6824aa408874b1e4.js integrity="sha256-BFyiJ9QXaAetWBpBCtyC8FeQ2b8eQbbeaCSqQIh0seQ=" crossorigin=anonymous></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]]},loader:{load:["ui/safe"]}}</script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/intro-to-backtesting/><span>파이썬으로 배우는 백테스팅 입문</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/intro-to-backtesting/docs/chapter01/>Chapter 1: 백테스팅 시작하기</a></li><li><a href=/intro-to-backtesting/docs/chapter02/>Chapter 2: 금융 데이터 다운로드와 이해</a></li><li><a href=/intro-to-backtesting/docs/chapter03/>Chapter 3: 데이터 전처리와 수익률</a></li><li><a href=/intro-to-backtesting/docs/chapter04/>Chapter 4: Backtrader 프레임워크 기초</a></li><li><a href=/intro-to-backtesting/docs/chapter05/>Chapter 5: 이동평균 전략</a></li><li><a href=/intro-to-backtesting/docs/chapter06/>Chapter 6: RSI 및 과매수/과매도 전략</a></li><li><a href=/intro-to-backtesting/docs/chapter07/>Chapter 7: Bollinger Bands 전략</a></li><li><a href=/intro-to-backtesting/docs/chapter08/>Chapter 8: 다중 지표 결합 전략</a></li><li><a href=/intro-to-backtesting/docs/chapter09/>Chapter 9: 포지션 크기 결정</a></li><li><a href=/intro-to-backtesting/docs/chapter10/>Chapter 10: 리스크 관리와 손절매</a></li><li><a href=/intro-to-backtesting/docs/chapter11/>Chapter 11: 포트폴리오 구성과 분산투자</a></li><li><a href=/intro-to-backtesting/docs/chapter12/>Chapter 12: 성과 지표와 리스크 측정</a></li><li><a href=/intro-to-backtesting/docs/chapter13/>Chapter 13: 백테스트 결과 분석과 시각화</a></li><li><a href=/intro-to-backtesting/docs/chapter14/>Chapter 14: 과최적화 방지와 검증</a></li><li><a href=/intro-to-backtesting/docs/chapter15/>Chapter 15: 머신러닝 기반 전략 (1)</a></li><li><a href=/intro-to-backtesting/docs/chapter16/ class=active>Chapter 16: 머신러닝 기반 전략 (2)</a></li><li><a href=/intro-to-backtesting/docs/chapter17/>Chapter 17: 실전 트레이딩 고려사항</a></li><li><a href=/intro-to-backtesting/docs/chapter18/>Chapter 18: 완전한 전략 개발 프로세스</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/intro-to-backtesting/icons/menu.svg class=book-icon alt=Menu></label><h3>Chapter 16: 머신러닝 기반 전략 (2)</h3><label for=toc-control><img src=/intro-to-backtesting/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#161-소개>16.1 소개</a></li><li><a href=#162-feature-importance-분석>16.2 Feature Importance 분석</a><ul><li><a href=#1621-트리-기반-모델의-feature-importance>16.2.1 트리 기반 모델의 Feature Importance</a></li><li><a href=#1622-permutation-importance>16.2.2 Permutation Importance</a></li></ul></li><li><a href=#163-앙상블-기법>16.3 앙상블 기법</a><ul><li><a href=#1631-투표-voting>16.3.1 투표 (Voting)</a></li><li><a href=#1632-스태킹-stacking>16.3.2 스태킹 (Stacking)</a></li></ul></li><li><a href=#164-backtrader와-ml-통합>16.4 Backtrader와 ML 통합</a><ul><li><a href=#1641-ml-strategy-구조>16.4.1 ML Strategy 구조</a></li><li><a href=#1642-온라인-학습-vs-오프라인-학습>16.4.2 온라인 학습 vs. 오프라인 학습</a></li><li><a href=#1643-재학습-전략>16.4.3 재학습 전략</a></li></ul></li><li><a href=#165-신호-필터링>16.5 신호 필터링</a><ul><li><a href=#1651-확률-임계값>16.5.1 확률 임계값</a></li><li><a href=#1652-다중-시그널-결합>16.5.2 다중 시그널 결합</a></li></ul></li><li><a href=#166-리스크-관리와-포지션-사이징>16.6 리스크 관리와 포지션 사이징</a><ul><li><a href=#1661-kelly-criterion-with-ml>16.6.1 Kelly Criterion with ML</a></li><li><a href=#1662-확률-기반-포지션-사이징>16.6.2 확률 기반 포지션 사이징</a></li></ul></li><li><a href=#167-모델-모니터링>16.7 모델 모니터링</a><ul><li><a href=#1671-성능-추적>16.7.1 성능 추적</a></li><li><a href=#1672-데이터-드리프트-감지>16.7.2 데이터 드리프트 감지</a></li></ul></li><li><a href=#168-실습-고급-ml-전략>16.8 실습: 고급 ML 전략</a><ul><li><a href=#코드-예제>코드 예제</a></li><li><a href=#주요-워크플로우>주요 워크플로우</a></li></ul></li><li><a href=#169-실전-고려사항>16.9 실전 고려사항</a><ul><li><a href=#1691-과적합-재검토>16.9.1 과적합 재검토</a></li><li><a href=#1692-계산-비용>16.9.2 계산 비용</a></li><li><a href=#1693-모델-해석-가능성>16.9.3 모델 해석 가능성</a></li></ul></li><li><a href=#1610-ml-전략-체크리스트>16.10 ML 전략 체크리스트</a></li><li><a href=#1611-실행-시-주의사항>16.11 실행 시 주의사항</a></li><li><a href=#1612-요약>16.12 요약</a></li><li><a href=#연습-문제>연습 문제</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=chapter-16-머신러닝-기반-전략-part-2>Chapter 16: 머신러닝 기반 전략 (Part 2)<a class=anchor href=#chapter-16-%eb%a8%b8%ec%8b%a0%eb%9f%ac%eb%8b%9d-%ea%b8%b0%eb%b0%98-%ec%a0%84%eb%9e%b5-part-2>#</a></h1><h2 id=161-소개>16.1 소개<a class=anchor href=#161-%ec%86%8c%ea%b0%9c>#</a></h2><p>이전 장에서는 기본적인 머신러닝 모델을 학습했습니다. 이 장에서는 더 고급 기법과 Backtrader와의 통합, 그리고 실전 적용 방법을 학습합니다.</p><h2 id=162-feature-importance-분석>16.2 Feature Importance 분석<a class=anchor href=#162-feature-importance-%eb%b6%84%ec%84%9d>#</a></h2><h3 id=1621-트리-기반-모델의-feature-importance>16.2.1 트리 기반 모델의 Feature Importance<a class=anchor href=#1621-%ed%8a%b8%eb%a6%ac-%ea%b8%b0%eb%b0%98-%eb%aa%a8%eb%8d%b8%ec%9d%98-feature-importance>#</a></h3><p>랜덤 포레스트와 그래디언트 부스팅은 각 특성의 중요도를 제공합니다:</p>$$\text{Importance}_i = \frac{\sum_{t \in T} \Delta \text{Gini}_i(t)}{|T|}$$<p>여기서:</p><ul><li>$T$: 모든 트리 집합</li><li>$\Delta \text{Gini}_i(t)$: 노드 $t$에서 특성 $i$에 의한 불순도 감소</li></ul><p><strong>활용</strong>:</p><ul><li>중요하지 않은 특성 제거</li><li>전략 해석</li><li>새로운 특성 아이디어 발굴</li></ul><h3 id=1622-permutation-importance>16.2.2 Permutation Importance<a class=anchor href=#1622-permutation-importance>#</a></h3><p>특성을 무작위로 섞었을 때 성능 하락 정도로 중요도 측정:</p><ol><li>기본 모델 성능 측정</li><li>특성 하나를 무작위로 섞기</li><li>성능 재측정</li><li>성능 차이가 중요도</li></ol><p><strong>장점</strong>:</p><ul><li>모델에 독립적</li><li>실제 예측 성능 반영</li></ul><h2 id=163-앙상블-기법>16.3 앙상블 기법<a class=anchor href=#163-%ec%95%99%ec%83%81%eb%b8%94-%ea%b8%b0%eb%b2%95>#</a></h2><h3 id=1631-투표-voting>16.3.1 투표 (Voting)<a class=anchor href=#1631-%ed%88%ac%ed%91%9c-voting>#</a></h3><p>여러 모델의 예측을 결합:</p><p><strong>하드 투표 (Hard Voting)</strong>:</p>$$\hat{y} = \text{mode}(h_1(x), h_2(x), \ldots, h_n(x))$$<p><strong>소프트 투표 (Soft Voting)</strong>:</p>$$\hat{y} = \arg\max_c \sum_{i=1}^{n} P_i(y=c|x)$$<h3 id=1632-스태킹-stacking>16.3.2 스태킹 (Stacking)<a class=anchor href=#1632-%ec%8a%a4%ed%83%9c%ed%82%b9-stacking>#</a></h3><p>여러 모델의 예측을 입력으로 하는 메타 모델:</p><ol><li>베이스 모델들 학습 (로지스틱 회귀, 랜덤 포레스트, XGBoost)</li><li>각 모델의 예측을 새로운 특성으로 사용</li><li>메타 모델 학습 (간단한 로지스틱 회귀)</li></ol><h2 id=164-backtrader와-ml-통합>16.4 Backtrader와 ML 통합<a class=anchor href=#164-backtrader%ec%99%80-ml-%ed%86%b5%ed%95%a9>#</a></h2><h3 id=1641-ml-strategy-구조>16.4.1 ML Strategy 구조<a class=anchor href=#1641-ml-strategy-%ea%b5%ac%ec%a1%b0>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MLStrategy</span>(bt<span style=color:#f92672>.</span>Strategy):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#75715e># 모델 로드</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>model <span style=color:#f92672>=</span> load_model(<span style=color:#e6db74>&#39;model.pkl&#39;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>scaler <span style=color:#f92672>=</span> load_scaler(<span style=color:#e6db74>&#39;scaler.pkl&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>next</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#75715e># 특성 계산</span>
</span></span><span style=display:flex><span>        features <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>calculate_features()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 예측</span>
</span></span><span style=display:flex><span>        prediction <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>model<span style=color:#f92672>.</span>predict(features)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 거래 실행</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> prediction <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>position:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>buy()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> prediction <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>position:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>close()</span></span></code></pre></div><h3 id=1642-온라인-학습-vs-오프라인-학습>16.4.2 온라인 학습 vs. 오프라인 학습<a class=anchor href=#1642-%ec%98%a8%eb%9d%bc%ec%9d%b8-%ed%95%99%ec%8a%b5-vs-%ec%98%a4%ed%94%84%eb%9d%bc%ec%9d%b8-%ed%95%99%ec%8a%b5>#</a></h3><p><strong>오프라인 학습</strong>:</p><ul><li>전체 훈련 데이터로 한 번 학습</li><li>모델 저장 후 백테스트에서 로드</li><li>간단하지만 적응력 부족</li></ul><p><strong>온라인 학습</strong>:</p><ul><li>백테스트 중 주기적으로 재학습</li><li>시장 변화에 적응</li><li>계산 비용 높음</li></ul><h3 id=1643-재학습-전략>16.4.3 재학습 전략<a class=anchor href=#1643-%ec%9e%ac%ed%95%99%ec%8a%b5-%ec%a0%84%eb%9e%b5>#</a></h3><p><strong>고정 윈도우 (Fixed Window)</strong>:</p><ul><li>항상 최근 N일 데이터로 학습</li><li>예: 최근 252일(1년)</li></ul><p><strong>확장 윈도우 (Expanding Window)</strong>:</p><ul><li>처음부터 현재까지 모든 데이터</li><li>데이터 누적</li></ul><p><strong>재학습 주기</strong>:</p><ul><li>매일: 계산 비용 높음, 최신 정보 반영</li><li>매주/매월: 현실적인 선택</li><li>분기별: 장기 전략</li></ul><h2 id=165-신호-필터링>16.5 신호 필터링<a class=anchor href=#165-%ec%8b%a0%ed%98%b8-%ed%95%84%ed%84%b0%eb%a7%81>#</a></h2><h3 id=1651-확률-임계값>16.5.1 확률 임계값<a class=anchor href=#1651-%ed%99%95%eb%a5%a0-%ec%9e%84%ea%b3%84%ea%b0%92>#</a></h3><p>단순히 클래스를 예측하는 대신 확률을 사용:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>prob <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict_proba(features)[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> prob <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.6</span>:  <span style=color:#75715e># 60% 이상 확신할 때만 매수</span>
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>buy()</span></span></code></pre></div><p><strong>장점</strong>:</p><ul><li>확신도 기반 거래</li><li>거래 빈도 조절</li><li>리스크 관리</li></ul><h3 id=1652-다중-시그널-결합>16.5.2 다중 시그널 결합<a class=anchor href=#1652-%eb%8b%a4%ec%a4%91-%ec%8b%9c%ea%b7%b8%eb%84%90-%ea%b2%b0%ed%95%a9>#</a></h3><p>여러 모델의 예측을 결합:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>lr_prob <span style=color:#f92672>=</span> lr_model<span style=color:#f92672>.</span>predict_proba(features)[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>rf_prob <span style=color:#f92672>=</span> rf_model<span style=color:#f92672>.</span>predict_proba(features)[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 평균 확률</span>
</span></span><span style=display:flex><span>avg_prob <span style=color:#f92672>=</span> (lr_prob <span style=color:#f92672>+</span> rf_prob) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> avg_prob <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.6</span>:
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>buy()</span></span></code></pre></div><h2 id=166-리스크-관리와-포지션-사이징>16.6 리스크 관리와 포지션 사이징<a class=anchor href=#166-%eb%a6%ac%ec%8a%a4%ed%81%ac-%ea%b4%80%eb%a6%ac%ec%99%80-%ed%8f%ac%ec%a7%80%ec%85%98-%ec%82%ac%ec%9d%b4%ec%a7%95>#</a></h2><h3 id=1661-kelly-criterion-with-ml>16.6.1 Kelly Criterion with ML<a class=anchor href=#1661-kelly-criterion-with-ml>#</a></h3><p>ML 모델의 승률과 손익비를 사용한 Kelly Criterion:</p>$$f^* = \frac{p \times b - q}{b}$$<p>여기서:</p><ul><li>$p$: 모델의 예상 승률</li><li>$q = 1 - p$</li><li>$b$: 평균 승리 / 평균 손실</li></ul><h3 id=1662-확률-기반-포지션-사이징>16.6.2 확률 기반 포지션 사이징<a class=anchor href=#1662-%ed%99%95%eb%a5%a0-%ea%b8%b0%eb%b0%98-%ed%8f%ac%ec%a7%80%ec%85%98-%ec%82%ac%ec%9d%b4%ec%a7%95>#</a></h3><p>확률에 따라 포지션 크기 조절:</p>$$\text{Position Size} = \text{Base Size} \times (2 \times \text{Probability} - 1)$$<p>예: 확률 70% → 포지션 크기 = Base × 0.4</p><h2 id=167-모델-모니터링>16.7 모델 모니터링<a class=anchor href=#167-%eb%aa%a8%eb%8d%b8-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81>#</a></h2><h3 id=1671-성능-추적>16.7.1 성능 추적<a class=anchor href=#1671-%ec%84%b1%eb%8a%a5-%ec%b6%94%ec%a0%81>#</a></h3><p>시간에 따른 모델 성능 변화 모니터링:</p><ul><li>예측 정확도</li><li>Precision/Recall</li><li>Calibration (예측 확률과 실제 빈도)</li></ul><h3 id=1672-데이터-드리프트-감지>16.7.2 데이터 드리프트 감지<a class=anchor href=#1672-%eb%8d%b0%ec%9d%b4%ed%84%b0-%eb%93%9c%eb%a6%ac%ed%94%84%ed%8a%b8-%ea%b0%90%ec%a7%80>#</a></h3><p>특성 분포가 훈련 시와 다르게 변하는지 확인:</p><p><strong>통계적 검정</strong>:</p><ul><li>Kolmogorov-Smirnov Test</li><li>Population Stability Index (PSI)</li></ul>$$PSI = \sum_{i=1}^{n} (\text{Actual}_i - \text{Expected}_i) \times \ln\left(\frac{\text{Actual}_i}{\text{Expected}_i}\right)$$<p><strong>해석</strong>:</p><ul><li>PSI &lt; 0.1: 안정적</li><li>PSI 0.1-0.25: 약간 변화</li><li>PSI > 0.25: 재학습 필요</li></ul><h2 id=168-실습-고급-ml-전략>16.8 실습: 고급 ML 전략<a class=anchor href=#168-%ec%8b%a4%ec%8a%b5-%ea%b3%a0%ea%b8%89-ml-%ec%a0%84%eb%9e%b5>#</a></h2><h3 id=코드-예제>코드 예제<a class=anchor href=#%ec%bd%94%eb%93%9c-%ec%98%88%ec%a0%9c>#</a></h3><p><code>codes/chapter16/</code>에서 다음을 구현합니다:</p><ol><li><strong>01_feature_importance.py</strong>: Feature importance 분석</li><li><strong>02_ensemble_models.py</strong>: 앙상블 기법 (Voting, Stacking)</li><li><strong>03_backtrader_ml_integration.py</strong>: Backtrader와 ML 통합</li><li><strong>04_online_learning.py</strong>: 재학습 전략 구현</li></ol><h3 id=주요-워크플로우>주요 워크플로우<a class=anchor href=#%ec%a3%bc%ec%9a%94-%ec%9b%8c%ed%81%ac%ed%94%8c%eb%a1%9c%ec%9a%b0>#</a></h3><ol><li><strong>모델 학습</strong>: 여러 ML 모델 학습 및 Feature importance 분석</li><li><strong>앙상블</strong>: 모델 결합으로 성능 향상</li><li><strong>백테스트 통합</strong>: Backtrader에서 ML 모델 사용</li><li><strong>재학습</strong>: 주기적 모델 업데이트</li><li><strong>성능 모니터링</strong>: 시간에 따른 성능 추적</li></ol><h2 id=169-실전-고려사항>16.9 실전 고려사항<a class=anchor href=#169-%ec%8b%a4%ec%a0%84-%ea%b3%a0%eb%a0%a4%ec%82%ac%ed%95%ad>#</a></h2><h3 id=1691-과적합-재검토>16.9.1 과적합 재검토<a class=anchor href=#1691-%ea%b3%bc%ec%a0%81%ed%95%a9-%ec%9e%ac%ea%b2%80%ed%86%a0>#</a></h3><p>ML 전략은 과적합 위험이 높습니다:</p><ul><li><strong>Walk-forward 분석 필수</strong></li><li><strong>Out-of-sample 성능 확인</strong></li><li><strong>여러 종목/시장에서 테스트</strong></li></ul><h3 id=1692-계산-비용>16.9.2 계산 비용<a class=anchor href=#1692-%ea%b3%84%ec%82%b0-%eb%b9%84%ec%9a%a9>#</a></h3><ul><li><strong>훈련 시간</strong>: 재학습 시 얼마나 걸리는가?</li><li><strong>예측 시간</strong>: 실시간으로 충분히 빠른가?</li><li><strong>메모리</strong>: 모델 크기가 적절한가?</li></ul><h3 id=1693-모델-해석-가능성>16.9.3 모델 해석 가능성<a class=anchor href=#1693-%eb%aa%a8%eb%8d%b8-%ed%95%b4%ec%84%9d-%ea%b0%80%eb%8a%a5%ec%84%b1>#</a></h3><ul><li><strong>규제 요구사항</strong>: 금융 규제에서 모델 설명 필요할 수 있음</li><li><strong>리스크 관리</strong>: 모델이 왜 그런 결정을 했는지 이해</li><li><strong>디버깅</strong>: 문제 발생 시 원인 파악</li></ul><h2 id=1610-ml-전략-체크리스트>16.10 ML 전략 체크리스트<a class=anchor href=#1610-ml-%ec%a0%84%eb%9e%b5-%ec%b2%b4%ed%81%ac%eb%a6%ac%ec%8a%a4%ed%8a%b8>#</a></h2><ul><li><input disabled type=checkbox> Look-ahead bias 방지 (Time Series Split)</li><li><input disabled type=checkbox> 특성 스케일링 (훈련 세트로만)</li><li><input disabled type=checkbox> Feature importance 분석</li><li><input disabled type=checkbox> Walk-forward 검증</li><li><input disabled type=checkbox> 앙상블 기법 고려</li><li><input disabled type=checkbox> 확률 임계값 설정</li><li><input disabled type=checkbox> 재학습 전략 설계</li><li><input disabled type=checkbox> 성능 모니터링 구현</li><li><input disabled type=checkbox> 여러 종목/시장에서 테스트</li><li><input disabled type=checkbox> 거래 비용 고려</li></ul><h2 id=1611-실행-시-주의사항>16.11 실행 시 주의사항<a class=anchor href=#1611-%ec%8b%a4%ed%96%89-%ec%8b%9c-%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad>#</a></h2><p><strong>코드 실행 특성</strong>:</p><p>이 챕터의 머신러닝 통합 코드는 계산 집약적(compute-intensive)입니다:</p><ol><li><p><strong>장시간 실행</strong>:</p><ul><li>특성 엔지니어링 + 모델 학습 + 백테스트 통합</li><li>주기적 재학습(rolling retraining)은 수십~수백 번 모델 학습</li><li><strong>예상 실행 시간</strong>: 5-30분 (데이터 크기 및 재학습 빈도에 따라)</li></ul></li><li><p><strong>메모리 요구사항</strong>:</p><ul><li>여러 모델 인스턴스 메모리 보유</li><li>특성 행렬 저장</li><li><strong>권장</strong>: 최소 4GB RAM</li></ul></li><li><p><strong>성능 최적화 옵션</strong>:</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 재학습 빈도 줄이기</span>
</span></span><span style=display:flex><span>retrain_freq <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>  <span style=color:#75715e># 5일 → 20일 (더 적은 재학습)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 앙상블 모델 개수 줄이기</span>
</span></span><span style=display:flex><span>n_estimators <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>  <span style=color:#75715e># 100 → 50</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 더 짧은 데이터 기간</span>
</span></span><span style=display:flex><span>start_date <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2022-01-01&#39;</span>  <span style=color:#75715e># 2019 → 2022</span></span></span></code></pre></div><p><strong>실행 팁</strong>:</p><ul><li>처음에는 작은 데이터셋으로 테스트</li><li>재학습 빈도를 늘려서 실행 시간 단축</li><li>모델이 제대로 작동하는지 확인 후 전체 데이터로 확장</li></ul><p><strong>Chapter 15와의 차이</strong>:</p><ul><li>Chapter 15: 독립적인 ML 모델 학습 및 평가 (빠름)</li><li>Chapter 16: Backtrader 통합 + 주기적 재학습 (느림)</li></ul><h2 id=1612-요약>16.12 요약<a class=anchor href=#1612-%ec%9a%94%ec%95%bd>#</a></h2><p>이 장에서는 다음을 학습했습니다:</p><ol><li><strong>Feature Importance</strong>: 중요한 특성 식별</li><li><strong>앙상블 기법</strong>: Voting, Stacking</li><li><strong>Backtrader 통합</strong>: ML 모델을 백테스트에 적용</li><li><strong>온라인 학습</strong>: 주기적 재학습</li><li><strong>신호 필터링</strong>: 확률 기반 거래</li><li><strong>모델 모니터링</strong>: 성능 추적 및 드리프트 감지</li></ol><p><strong>핵심 인사이트</strong>:</p><ul><li>ML 모델을 실제 백테스트에 통합하는 것은 복잡하지만 강력함</li><li>주기적 재학습으로 시장 변화에 적응</li><li>확률 기반 신호 필터링으로 신뢰도 높은 거래만 선택</li><li>Feature importance로 전략 해석 가능성 확보</li><li>모델 드리프트 모니터링은 실전 운용의 필수 요소</li><li>Chapter 15의 낮은 AUC는 ML이 항상 성공하지 않음을 보여주는 현실적 사례</li></ul><p><strong>실전 적용</strong>:</p><ul><li>ML 전략은 개발과 유지보수에 많은 노력 필요</li><li>단순 규칙 기반 전략이 더 나을 수도 있음</li><li>ML의 강점은 복잡한 패턴 인식과 비선형 관계 포착</li><li>하지만 데이터가 부족하거나 시장이 효율적이면 효과 제한적</li></ul><p>다음 장에서는 실전 트레이딩의 현실적인 고려사항을 학습합니다.</p><h2 id=연습-문제>연습 문제<a class=anchor href=#%ec%97%b0%ec%8a%b5-%eb%ac%b8%ec%a0%9c>#</a></h2><ol><li>Feature importance를 분석하고, 하위 50% 특성을 제거했을 때 성능 변화를 확인해보세요.</li><li>3개 이상의 모델로 앙상블을 구성하고, 단일 모델 대비 성능을 비교해보세요.</li><li>재학습 주기를 변경하며 (매주, 매월, 분기) 성능 차이를 분석해보세요.</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/intro-to-backtesting/docs/chapter15/ class="flex align-center"><img src=/intro-to-backtesting/icons/backward.svg class=book-icon alt=Backward>
<span>Chapter 15: 머신러닝 기반 전략 (1)</span>
</a></span><span><a href=/intro-to-backtesting/docs/chapter17/ class="flex align-center"><span>Chapter 17: 실전 트레이딩 고려사항</span>
<img src=/intro-to-backtesting/icons/forward.svg class=book-icon alt=Forward></a></span></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#161-소개>16.1 소개</a></li><li><a href=#162-feature-importance-분석>16.2 Feature Importance 분석</a><ul><li><a href=#1621-트리-기반-모델의-feature-importance>16.2.1 트리 기반 모델의 Feature Importance</a></li><li><a href=#1622-permutation-importance>16.2.2 Permutation Importance</a></li></ul></li><li><a href=#163-앙상블-기법>16.3 앙상블 기법</a><ul><li><a href=#1631-투표-voting>16.3.1 투표 (Voting)</a></li><li><a href=#1632-스태킹-stacking>16.3.2 스태킹 (Stacking)</a></li></ul></li><li><a href=#164-backtrader와-ml-통합>16.4 Backtrader와 ML 통합</a><ul><li><a href=#1641-ml-strategy-구조>16.4.1 ML Strategy 구조</a></li><li><a href=#1642-온라인-학습-vs-오프라인-학습>16.4.2 온라인 학습 vs. 오프라인 학습</a></li><li><a href=#1643-재학습-전략>16.4.3 재학습 전략</a></li></ul></li><li><a href=#165-신호-필터링>16.5 신호 필터링</a><ul><li><a href=#1651-확률-임계값>16.5.1 확률 임계값</a></li><li><a href=#1652-다중-시그널-결합>16.5.2 다중 시그널 결합</a></li></ul></li><li><a href=#166-리스크-관리와-포지션-사이징>16.6 리스크 관리와 포지션 사이징</a><ul><li><a href=#1661-kelly-criterion-with-ml>16.6.1 Kelly Criterion with ML</a></li><li><a href=#1662-확률-기반-포지션-사이징>16.6.2 확률 기반 포지션 사이징</a></li></ul></li><li><a href=#167-모델-모니터링>16.7 모델 모니터링</a><ul><li><a href=#1671-성능-추적>16.7.1 성능 추적</a></li><li><a href=#1672-데이터-드리프트-감지>16.7.2 데이터 드리프트 감지</a></li></ul></li><li><a href=#168-실습-고급-ml-전략>16.8 실습: 고급 ML 전략</a><ul><li><a href=#코드-예제>코드 예제</a></li><li><a href=#주요-워크플로우>주요 워크플로우</a></li></ul></li><li><a href=#169-실전-고려사항>16.9 실전 고려사항</a><ul><li><a href=#1691-과적합-재검토>16.9.1 과적합 재검토</a></li><li><a href=#1692-계산-비용>16.9.2 계산 비용</a></li><li><a href=#1693-모델-해석-가능성>16.9.3 모델 해석 가능성</a></li></ul></li><li><a href=#1610-ml-전략-체크리스트>16.10 ML 전략 체크리스트</a></li><li><a href=#1611-실행-시-주의사항>16.11 실행 시 주의사항</a></li><li><a href=#1612-요약>16.12 요약</a></li><li><a href=#연습-문제>연습 문제</a></li></ul></nav></div></aside></main></body></html>